<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"misakatang.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"style":null,"show_result":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The limits of my language are the limits of my world">
<meta property="og:type" content="website">
<meta property="og:title" content="MisakaTang&#39;s Blog">
<meta property="og:url" content="http://misakatang.cn/page/20/index.html">
<meta property="og:site_name" content="MisakaTang&#39;s Blog">
<meta property="og:description" content="The limits of my language are the limits of my world">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="MisakaTang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://misakatang.cn/page/20/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/20/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MisakaTang's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4TSLH4NC9H"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-4TSLH4NC9H","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?de7c77febeeac252eee468207ae11ce4"></script>



  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "jtb4czrfeu");
</script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="MisakaTang's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">MisakaTang's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="MisakaTang"
      src="/images/misaka.jpg">
  <p class="site-author-name" itemprop="name">MisakaTang</p>
  <div class="site-description" itemprop="description">The limits of my language are the limits of my world</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/%E5%BD%92%E6%A1%A3/">
          <span class="site-state-item-count">101</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">100</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/TangMisaka23001" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;TangMisaka23001" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mikasatang@gmail.com" title="E-Mail → mailto:mikasatang@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="http://blog.bbchen.top/" title="http:&#x2F;&#x2F;blog.bbchen.top" rel="noopener" target="_blank">BB chen的漂流记</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://blog.zhuzhenyuan.cn/" title="http:&#x2F;&#x2F;blog.zhuzhenyuan.cn" rel="noopener" target="_blank">Aurthur_的博客</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://misakatang.cn/2018/11/03/%E4%B8%8D%E5%8A%A8%E7%82%B9-%E9%80%92%E5%BD%92-%E4%BA%8C%E8%BF%9B%E5%88%B6-%E5%A5%87%E5%A6%99%E7%9A%84%E5%88%86%E5%BD%A2%E4%B8%89%E8%A7%92%E5%BD%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/misaka.jpg">
      <meta itemprop="name" content="MisakaTang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MisakaTang's Blog">
      <meta itemprop="description" content="The limits of my language are the limits of my world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | MisakaTang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/11/03/%E4%B8%8D%E5%8A%A8%E7%82%B9-%E9%80%92%E5%BD%92-%E4%BA%8C%E8%BF%9B%E5%88%B6-%E5%A5%87%E5%A6%99%E7%9A%84%E5%88%86%E5%BD%A2%E4%B8%89%E8%A7%92%E5%BD%A2/" class="post-title-link" itemprop="url">不动点,递归,二进制--奇妙的分形三角形</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-11-03 16:46:51" itemprop="dateCreated datePublished" datetime="2018-11-03T16:46:51+00:00">2018-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-03-14 08:33:24" itemprop="dateModified" datetime="2024-03-14T08:33:24+00:00">2024-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/%E5%88%86%E7%B1%BB/%E7%94%9F%E6%B4%BB/" itemprop="url" rel="index"><span itemprop="name">生活</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>我看到了它，却不敢相信它.—<em>by康托尔</em></p>
</blockquote>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这是一个我想写了很久的话题,但是却迟迟没有开始,因为这个话题过于艰深而且涉及的知识面已经超出了我的边际,然而在这几周重读了递归之后还是打算将其记录下来,记录下这令人神往着迷的美妙的数学世界的经历.</p>
<p>标题很自大地致敬了**<a target="_blank" rel="noopener" href="https://book.douban.com/subject/1291204/">哥德尔、艾舍尔、巴赫–集异璧之大成</a>**这本刷新我认知的奇书</p>
<p>**<a target="_blank" rel="noopener" href="http://mindhacks.cn/2006/10/15/cantor-godel-turing-an-eternal-golden-diagonal/">康托尔、哥德尔、图灵——永恒的金色对角线</a>**这篇我非常喜欢的关于不动点的博客.</p>
<h1 id="从递归说起"><a href="#从递归说起" class="headerlink" title="从递归说起"></a>从递归说起</h1><p>递归,这个编程中基础到不能再基础的知识点,却在我开始学习SICP之后一次次刷新着我的编程观,<em>大道化简</em>,即便是这样一个在认知中基础得不能再基础的编程方式也以其独特的魅力向我们展示着编程和数学中隐藏着的深刻而绮丽的美丽之处.</p>
<h2 id="汉诺塔"><a href="#汉诺塔" class="headerlink" title="汉诺塔"></a>汉诺塔</h2><p>这是一个几乎每个学习编程的人都会学到的关于递归的最好的例子,在此就不再详述这个问题的介绍了,<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B1%89%E8%AF%BA%E5%A1%94">维基百科链接在这里</a>.</p>
<p>给出移动的流程:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">移动4个盘子=</span><br><span class="line">    移动3个盘子到B</span><br><span class="line">    移动最大的盘子到C</span><br><span class="line">    移动3个盘子到C</span><br></pre></td></tr></table></figure>
<p>下面给出python版本的解法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_toh</span>(<span class="params">n_disks</span>):</span><br><span class="line">    <span class="keyword">if</span> n_disks == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    solve_toh(n_disks-<span class="number">1</span>)</span><br><span class="line">    move_disk(n_disks-<span class="number">1</span>)</span><br><span class="line">    solve_toh(n_disks-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>这个凝聚了大量的智力劳动的问题却以其极简的表达形式展示了出来而且是这么的容易被理解,这也是递归的魅力所在吧.</p>
<h2 id="二进制"><a href="#二进制" class="headerlink" title="二进制"></a>二进制</h2><p>下面我们引入二进制,当然这也是非常基础的计算机知识了,但是这里我们需要关注的是它的计数规律:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数出二进制1111=</span><br><span class="line">    数出二进制0111:     0111</span><br><span class="line">    将首位置1,后三位恢复:1000</span><br><span class="line">    数出二进制0111:     1111</span><br></pre></td></tr></table></figure>
<p>可以看到的是,这个过程是非常递归的一个过程,1111需要先数0111而0111需要先数0011…..那么这和汉诺塔有什么关系呢?让我们这样来考虑问题:</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd674da4399.png"></p>
<p>我们将A柱子上的4个盘子记为一个4位二进制数,它的起始状态就是0000,然后我们开始计数:0001,0010,0011….而每次某个二进制位变成1的时候,就将对应的盘子向右移动一个柱子(到最左的话就移动到A),如:0001就是将编号为0的盘右移到B:</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd6845048f5.png"></p>
<p>然后如此循环,我们就可以解决汉诺塔问题.当我看到这里的时候我是很惊异的,这难道只是一个巧合吗?我们来观察一下上面的2段代码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">solve_toh(n_disks-1)</span><br><span class="line">move_disk(n_disks-1)</span><br><span class="line">solve_toh(n_disks-1)</span><br><span class="line"></span><br><span class="line">数出二进制0111:     0111</span><br><span class="line">将首位置1,后三位恢复:1000</span><br><span class="line">数出二进制0111:     1111</span><br></pre></td></tr></table></figure>
<p><strong>正好一一对应,不是吗?</strong></p>
<p>也就是说,移动编号为1的盘子,需要移动0号盘子2^1-1&#x3D;1下,而移动2号盘子需要移动0号和1号盘子总共2^2-1&#x3D;3下,而3下中也是0号2下,1号1下,明显的是:<strong>二进制数字变化是递归的且和每个盘的变化是一一对应的.</strong></p>
<h1 id="还是递归"><a href="#还是递归" class="headerlink" title="还是递归"></a>还是递归</h1><h2 id="匿名递归"><a href="#匿名递归" class="headerlink" title="匿名递归"></a>匿名递归</h2><p>在SICP第一章中我们就了解到,我们可以将求根的函数和寻找一个函数的不动点结合起来,只要这个函数在迭代的过程中是收敛的,比如(其中的fixed-point就是寻找不动点的函数):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(define (f x)</span><br><span class="line">    (/ 2(+ x (/ x 2))))</span><br><span class="line"></span><br><span class="line">(define (sqrt x)</span><br><span class="line">    (fixed-point f 1))</span><br></pre></td></tr></table></figure>
<p>在<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%8D%E5%8A%A8%E7%82%B9">维基百科</a>的定义中,函数的不动点就是x&#x3D;f(x)的点,但是这对于递归有什么意义呢?我们这样来思考问题:写一个lamdba表达式来实现递归求解阶乘.</p>
<h2 id="阶乘"><a href="#阶乘" class="headerlink" title="阶乘"></a>阶乘</h2><p>那么就先把函数给写出来:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lamdba n: n==0?1,self*(n-1)</span><br></pre></td></tr></table></figure>
<p>这里的self就是这个函数的名称,在不使用匿名函数的时候,固然是很简单的,直接将函数名填进去就行了,但是lamdba就不行了,因为在函数被定义之前它是没有名字的.既然我们不能直接填入函数名,那么就将其<em>参数化</em>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lamdba self,n: n==0?1,self*(n-1)</span><br></pre></td></tr></table></figure>
<p>然后我们给他加一个名字:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let P = lamdba self,n: n==0?1,self*(n-1)</span><br></pre></td></tr></table></figure>
<p>观察这个函数我们可以发现,如果调用P的时候,我们传一个<strong>真正的阶乘函数</strong>进去,那么P(power, 10)就可以正确的求解阶乘了.恩?但是我们不就是在找一个阶乘函数吗?虽然有这样的疑惑,但是还是先写一个出来再说嘛:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">power(n) = n==0? 1,n*power(n-1)</span><br></pre></td></tr></table></figure>
<p>然后我们靠柯里把这个函数变成这样:<code>P(power)</code>,也就是说这个函数还等待接收一个数字就能求出对应的阶乘了.恩?等等,这个power也不行啊,这也是个不存在的函数啊!那么别急,先展开一下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P(power) = n==0?1,power(n-1)</span><br></pre></td></tr></table></figure>
<p>恩?这不就是power的定义吗,what?是的,<code>P(power)=power</code>了!,这是什么,这不就是函数的不动点吗!也就是说,对于伪递归函数P,存在一个点power使得P(power)&#x3D;power,那么问题就变成了,我们要找到一个工具,只要对P用一下这个工具,我们就能获得power,power是什么?power可是一个<strong>真正的递归函数</strong>啊,那么这个问题就解决了.也就是说:找到一个函数Y,使得Y(P)&#x3D;power:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Y(P)=power</span><br><span class="line">因为:P(power)=power</span><br><span class="line">所以:Y(P)=power=P(power)=P(Y(P))</span><br><span class="line">也就是说:Y(P)=P(Y(P))</span><br></pre></td></tr></table></figure>
<p>那么问题就变成了寻找这个Y,似乎问题到了这里也没有丝毫推进但是只要得到Y,那么这就是一个银弹可以对任何一个函数使用,就可以得到其真正的递归函数.让我们回到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let P = lamdba self,n: n==0?1,self*(n-1)</span><br></pre></td></tr></table></figure>
<p>如果我们调用P(P,3)会得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3==0?1,P(3-1)</span><br></pre></td></tr></table></figure>
<p>发现并不能继续循环调用下去,那么我们调整一下P函数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let P = lamdba self,n: n==0?1,self*(self, n-1)</span><br></pre></td></tr></table></figure>
<p>那么上面的调用就会变成:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3==0?1,P(P,3-1) ==&gt; P(P,2)</span><br></pre></td></tr></table></figure>
<p>诶?这不是就搞定了吗,那我们绕这么远的路还要寻找Y干嘛呢?我们将这个思想代入到Y中:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let Y = lambda F: </span><br><span class="line">    let f= lambda self: F(self(self))</span><br><span class="line">    return f(f)</span><br></pre></td></tr></table></figure>
<p>用P代入:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Y(P):</span><br><span class="line">    let f = lamdba self: P(self(self))</span><br><span class="line">    return f(f)</span><br><span class="line">也就是:</span><br><span class="line">Y(P)=f(f)</span><br><span class="line">而f(f)根据定义可以得到:</span><br><span class="line">f(f)=P(f(f))</span><br><span class="line">也就是:</span><br><span class="line">Y(P)=f(f)=P(f(f))</span><br></pre></td></tr></table></figure>
<p>将其代回P函数中:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P(f(f)) = lambda: n==0?1,n*P(f(f))(n-1)</span><br><span class="line">假设P(f(f))=fib,那么:</span><br><span class="line">fib = lambda: n==0?1,n*fib(n-1)</span><br></pre></td></tr></table></figure>
<p>终于得到了一个完美的阶乘函数!而这个Y不是别的,就是Y组合子.也就是说,只要使用Y组合子这个神奇的函数,我们就可以获得所有函数的递归形式.</p>
<blockquote>
<p>我们赋予了函数式编程能够表达递归的能力</p>
</blockquote>
<p>下面给出一个python的实现:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">y_combinator</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">lambda</span> u: u(u))(<span class="keyword">lambda</span> x: f(<span class="keyword">lambda</span> *args: x(x)(*args)))</span><br></pre></td></tr></table></figure>
<p>那么匿名的阶乘函数就如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_combinator(<span class="keyword">lambda</span> fab: <span class="keyword">lambda</span> n: <span class="number">1</span> <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> n * fab(n-<span class="number">1</span>))(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>在SICP的课程开始,老师说过:如果我们想要操纵一个精灵(函数)只要能够叫出它的名字就可以,而有了Y组合子的帮助,我们能够操纵一大类叫做匿名函数的精灵了.</p>
<p>Congratulations!你已经正式加入了Lisp邪教!这是会徽:</p>
<p><img src="https://i.loli.net/2018/11/04/5bde900e67445.jpg"></p>
<h1 id="递归艺术"><a href="#递归艺术" class="headerlink" title="递归艺术"></a>递归艺术</h1><p>爱舍尔有一副很有名的画–画手,这也是一个将递归在绘画艺术中发挥到极致的画家了.</p>
<p><img src="https://i.loli.net/2018/11/04/5bde9021b7e04.jpg"></p>
<p>可以看到这也是一个很递归的过程,而在SICP的第四章中,eval和apply就像是图上的两只手,在互相描绘着对方.</p>
<h2 id="print-itself"><a href="#print-itself" class="headerlink" title="print itself"></a>print itself</h2><p>我们可以让一个程序输出它本身吗?下面给出一个js的实现和一个python的实现:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">s</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;(&#x27;</span> + s + <span class="string">&#x27;)(&#x27;</span> + s + <span class="string">&#x27;)&#x27;</span> )&#125;)(<span class="keyword">function</span> (<span class="params">s</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;(&#x27;</span> + s + <span class="string">&#x27;)(&#x27;</span> + s + <span class="string">&#x27;)&#x27;</span> )&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="keyword">lambda</span> x:x+`(x,)`)(<span class="string">&#x27;print(lambda x:x+`(x,)`)&#x27;</span>,)</span><br></pre></td></tr></table></figure>

<h1 id="递归分形"><a href="#递归分形" class="headerlink" title="递归分形"></a>递归分形</h1><p>在SICP第二章中,我们使用Lisp来实现过一个能够画出递归的图片的语言,效果如下:</p>
<p><img src="https://img.alicdn.com/imgextra/i3/581166664/TB2lhtEfFXXXXaRXpXXXXXXXXXX_!!581166664.png"></p>
<p>还有一种分形的图形叫做<strong>谢尔宾斯基三角形</strong></p>
<p><img src="https://pic4.zhimg.com/80/v2-23a777941880395ec1befe510f7d0bbf_hd.png"></p>
<p>一种递归的实现方法是每次连接一个三角形的三条边的中点,然后对所有的三角形重复这个过程.伪代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sierpinski</span>(<span class="params">points,degree</span>):</span><br><span class="line">   drawTriangle(points)</span><br><span class="line">    <span class="keyword">if</span> degree &gt; <span class="number">0</span>:</span><br><span class="line">        sierpinski([points[<span class="number">0</span>],</span><br><span class="line">                        getMid(points[<span class="number">0</span>],points[<span class="number">1</span>]),</span><br><span class="line">                        getMid(points[<span class="number">0</span>],points[<span class="number">2</span>])],</span><br><span class="line">                   degree-<span class="number">1</span>)</span><br><span class="line">        sierpinski([points[<span class="number">1</span>],</span><br><span class="line">                        getMid(points[<span class="number">0</span>],points[<span class="number">1</span>]),</span><br><span class="line">                        getMid(points[<span class="number">1</span>],points[<span class="number">2</span>])],</span><br><span class="line">                   degree-<span class="number">1</span>)</span><br><span class="line">        sierpinski([points[<span class="number">2</span>],</span><br><span class="line">                        getMid(points[<span class="number">2</span>],points[<span class="number">1</span>]),</span><br><span class="line">                        getMid(points[<span class="number">0</span>],points[<span class="number">2</span>])],</span><br><span class="line">                   degree-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="还是汉诺塔"><a href="#还是汉诺塔" class="headerlink" title="还是汉诺塔"></a>还是汉诺塔</h2><p>(你说的是三角形,关我汉诺塔什么事?)</p>
<p>我们来改变一下移动汉诺塔的策略,每次移动的时候只能把圆盘移动到相邻的柱子上,改变了策略之后会发生什么呢?我们来假设移动一下4个盘子:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">移动4个盘子=</span><br><span class="line">    移动3个盘子到C</span><br><span class="line">    移动最大的盘子到B</span><br><span class="line">    移动3个盘子到A</span><br><span class="line">    移动最大的盘子到C</span><br><span class="line">    移动三个盘子到B</span><br><span class="line">    移动三个盘子到C</span><br></pre></td></tr></table></figure>
<p>如果这时候我们还要保持每一位数的变化和对应盘子的移动的话,可以看一下上面的流程:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">移动4个盘子=</span><br><span class="line">    移动3个盘子到B</span><br><span class="line">    移动最大的盘子到C</span><br><span class="line">    移动3个盘子到C</span><br></pre></td></tr></table></figure>
<p>很自然的可以想到,因为每次都多移动了一下,那么使用<strong>三进制</strong>怎么样?right</p>
<p>这时候事情就变得有趣了起来,让我们想一下:4个盘子进行移动一共移动多少下?3^4&#x3D;81次.4个盘子总共可以产生的不重复的盘子分布状态是几种?</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd8a31e0906.png"></p>
<p>3*3*3*3&#x3D;81种,这是巧合吗?也就是说,上面按照三进制的走法就是最优解了(因为如果前后有重复的状态的话,中间的步骤就可以被省略了),事情变得非常有趣了起来.</p>
<p>我们把所有可能的盘子状态按照两个直接可以一步做到的方式连在一起,例如(0号盘可以相互一步到达):</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd8b57f364b.png"></p>
<p>这样把全部的盘面都连接在一起的话:</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd8bc1c0781.png"></p>
<p>恩?这是什么?这不是<strong>谢尔宾斯基三角形</strong>嘛</p>
<blockquote>
<p>虽然难以置信,但是事情就是这样发生了</p>
</blockquote>
<p>是的,虽然大家平时完全不见面,但是通过递归使得分形和汉诺塔联系在了一起.</p>
<blockquote>
<p>当你一旦发现了数学中的某些规律在你的知识的每个角落都散发着光芒的时候,这将你深深吸引的绚丽的光芒就将指引着你去寻找更多美丽的存在. —<em>by沃·兹基硕德</em></p>
</blockquote>
<p>那么最优解呢?最优解也是可以找到的</p>
<p><img src="https://i.loli.net/2018/11/03/5bdd8d7c31829.png"></p>
<p>看到这里,相信没有人会不感叹数学之美以及这递归中的种种巧合与联系.</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>总感觉意犹未尽但是又说不出来,写完也总是不能令自己满意,但是总也不写的话就会一直惦记着,就先把想到的写出来要是以后还有再继续补充罢.</p>
<p>关于Y组合子和停机问题以及哥德尔不完备定理的内容还是参见<a target="_blank" rel="noopener" href="http://mindhacks.cn/2006/10/15/cantor-godel-turing-an-eternal-golden-diagonal/">康托尔、哥德尔、图灵——永恒的金色对角线</a>这篇文章和<a target="_blank" rel="noopener" href="https://book.douban.com/subject/1291204/">哥德尔、艾舍尔、巴赫–集异璧之大成</a>这本书,这里空白太小写不下.</p>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av7398130">用二进制来解汉诺塔问题</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av7539453?spm_id_from=333.788.b_765f64657363.1">隐藏在汉诺塔中的分形曲线</a></p>
<p><a target="_blank" rel="noopener" href="http://mindhacks.cn/2006/10/15/cantor-godel-turing-an-eternal-golden-diagonal/">康托尔、哥德尔、图灵——永恒的金色对角线</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/53448865">谢尔宾斯基三角形能用编程写出来么？该怎么写？</a></p>
<p><a target="_blank" rel="noopener" href="http://zzp.me/2013-09-05/y-combinator/">10种编程语言实现Y组合子</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/python2014/article/details/22604367">python数据结构与算法 23 宾斯基三角形</a></p>
<p><a target="_blank" rel="noopener" href="http://io.upyun.com/2016/04/05/recursion/">谈谈递归</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.windrunner.me/programming/quine.html">Quine 是什么</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://misakatang.cn/2018/10/20/SICP%E8%AF%BB%E4%B9%A6%E6%80%BB%E7%BB%93-%E7%AC%AC%E4%B8%89%E7%AB%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/misaka.jpg">
      <meta itemprop="name" content="MisakaTang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MisakaTang's Blog">
      <meta itemprop="description" content="The limits of my language are the limits of my world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | MisakaTang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/20/SICP%E8%AF%BB%E4%B9%A6%E6%80%BB%E7%BB%93-%E7%AC%AC%E4%B8%89%E7%AB%A0/" class="post-title-link" itemprop="url">SICP读书总结-第三章</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-20 15:51:54" itemprop="dateCreated datePublished" datetime="2018-10-20T15:51:54+00:00">2018-10-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-03-14 08:33:24" itemprop="dateModified" datetime="2024-03-14T08:33:24+00:00">2024-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/%E5%88%86%E7%B1%BB/%E7%94%9F%E6%B4%BB/" itemprop="url" rel="index"><span itemprop="name">生活</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Even while it changes, it stands still</p>
</blockquote>
<hr>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>第三章的阅读之路也算是比较漫长了,和计划的SICP进度可能还是差距很大,但是好歹也是在慢慢推进了..第三章内容算是比较杂的但是挺重要的吧,特别是在这个流和分布式被越来越重视的8102年,而且在工作之后再来看这些问题也是有很多的新收获,确实很多知识虽然过了几十年,其实本质上是没有什么变化的,而我的感觉就是SICP提供给我一种从语言的角度来看待计算机问题的角度,从而使得对很多问题的思考更加全面和多样了.</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>在前两章的基础上,在我们构建系统的时候,还需要一些知识来使得我们在构建大型的系统时使得系统更具模块性,我们希望这种策略能够在有新的对象或者动作添加进系统的时候不需要修改原有的代码,只需要加一些额外的代码(symbolic analogs)就能够解决问题.</p>
<p>在我们构建系统的时候有两种看待事物的角度:</p>
<ul>
<li>第一种是把一个大型系统视为对象的集合,而对象的行为可能随时间变化</li>
<li>第二种是像电子工程师一样把系统看作是信号处理系统,把系统看成是信号在元件之间流动.</li>
</ul>
<h2 id="赋值和局部状态"><a href="#赋值和局部状态" class="headerlink" title="赋值和局部状态"></a>赋值和局部状态</h2><p>看待系统中状态变化的一种观点是:状态变化可以被分组成几个紧密相关的子系统并且子系统之间的关系要保持松散.这也就导致我们想到要使得每个对象都有其局部的状态(local state varibles)</p>
<h3 id="引入set"><a href="#引入set" class="headerlink" title="引入set!"></a>引入set!</h3><p>比如在取钱的时候,我们的流程应该是下面这样的:假设我们有100块钱</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(withdraw 25)</span><br><span class="line">75</span><br><span class="line">(withdraw 25)</span><br><span class="line">50</span><br><span class="line">(withdraw 60)</span><br><span class="line">&quot;Insufficient funds&quot;</span><br><span class="line">(withdraw 15)</span><br><span class="line">35</span><br></pre></td></tr></table></figure>
<p>而这样的求值方式前面没有状态的函数肯定是做不到的了,因为每次调用相同的函数都会产生不同的结果了.这时候就需要引入<strong>赋值</strong>,也就是set!.代码的实现如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(define balance 100)</span><br><span class="line">(define (withdraw amount)</span><br><span class="line">    (if (&gt;= balance amount)</span><br><span class="line">        (begin (set! balance (- balance amount))</span><br><span class="line">            balance)</span><br><span class="line">        &quot;Insufficient founds&quot;))</span><br></pre></td></tr></table></figure>
<p>而set!的引入也导致前面的替换模型的规则就失效了.因为balance变成了一个绑定在全局环境里的变量.</p>
<h3 id="引入赋值的好处"><a href="#引入赋值的好处" class="headerlink" title="引入赋值的好处"></a>引入赋值的好处</h3><blockquote>
<p>It is tempting to conclude this discussion by saying that, by introducing assignment and the technique of hiding state in local variables, we are able to structure systems in a more modular fashion than if all state had to be manipulated explicitly, by passing additional parameters.</p>
</blockquote>
<p>通过局部状态可以使得我们更加模块化的来构建系统.</p>
<h3 id="引入赋值的代价"><a href="#引入赋值的代价" class="headerlink" title="引入赋值的代价"></a>引入赋值的代价</h3><p>那么,代价是什么呢?</p>
<ol>
<li>替换模型在这里不再适用了</li>
<li>由于引入了赋值,函数的执行顺序变得重要了,我们也失去了函数式编程的一部分优雅</li>
<li>我们不得不接受命令式编程一样的复杂性</li>
</ol>
<blockquote>
<p>programming with assignment forces us to carefully consider the relative orders of the assignments to make sure that each statement is using the correct version of the variables that have been changed.This issue simply does not arise in functional programs</p>
</blockquote>
<h2 id="求值的环境模型"><a href="#求值的环境模型" class="headerlink" title="求值的环境模型"></a>求值的环境模型</h2><p>为了应付set!这个需求,我们需要引入一个叫做环境的结构,环境就是一系列的帧(frames)构成的.而相对应的,环境模型的求值规则是:</p>
<ol>
<li>Evaluate the subexpressions of the combination.</li>
<li>Apply the value of the operator subexpression to the values of the operand subexpressions.</li>
</ol>
<p>大致就是为每一个子表达式创建一个自己的环境,然后绑定它的父表达式,子表达式内的变量自己用,求值的时候的感觉就是自底向上求值.</p>
<h3 id="用帧来存储局部状态"><a href="#用帧来存储局部状态" class="headerlink" title="用帧来存储局部状态"></a>用帧来存储局部状态</h3><p>根据上面的规则翻译一下上面从银行取钱的函数就是这样的:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(define (make-withdraw balance)</span><br><span class="line">  (lambda (amount)</span><br><span class="line">    (if (&gt; amount balance)</span><br><span class="line">      &quot;Insufficient&quot;</span><br><span class="line">      (begin</span><br><span class="line">        (set! balance (- balance amount))</span><br><span class="line">        balance))))</span><br><span class="line"></span><br><span class="line">(define W1 (make-withdraw 100))</span><br><span class="line">(W1 50)</span><br></pre></td></tr></table></figure>
<p><img src="https://img.alicdn.com/imgextra/i2/581166664/TB2WwebiVXXXXcxXXXXXXXXXXXX_!!581166664.png"></p>
<p>求值<code>(W1 50)</code>的过程如下图:</p>
<p><img src="https://img.alicdn.com/imgextra/i1/581166664/TB2mo5iiVXXXXa.XXXXXXXXXXXX_!!581166664.png"></p>
<p>环境模型解释了使得局部过程定义变成模块化编程中实用技巧的两个关键特性:</p>
<ul>
<li>局部过程被绑定在自己的帧中,只在运行时被创建,优于全部绑定在全局变量中的方式</li>
<li>局部过程可以轻松访问绑定环境中的参数,因为这是一个对其封闭的过程.</li>
</ul>
<h2 id="对可变的数据进行模块化"><a href="#对可变的数据进行模块化" class="headerlink" title="对可变的数据进行模块化"></a>对可变的数据进行模块化</h2><p>主要还是讲一些数据结构,但是使用了新的技术.</p>
<h3 id="Mutable-List-Structure"><a href="#Mutable-List-Structure" class="headerlink" title="Mutable List Structure"></a>Mutable List Structure</h3><p>主要是借助set!来实现对List进行可变的操作.下图就是把x的cdr变成y的图片(set-cdr! x y)</p>
<p><img src="https://i.loli.net/2018/10/20/5bcaee4fd0b08.png"></p>
<h3 id="表示队列"><a href="#表示队列" class="headerlink" title="表示队列"></a>表示队列</h3><p>队列的概念和操作就不写了,大致就是用set!来修改队首和队尾来实现一个队列.</p>
<p><img src="https://img.alicdn.com/imgextra/i3/581166664/TB27OhWiVXXXXcjXpXXXXXXXXXX_!!581166664.png"></p>
<h3 id="表示表格-Tables"><a href="#表示表格-Tables" class="headerlink" title="表示表格(Tables)"></a>表示表格(Tables)</h3><p>key-value的形式,和字典或者JSON比较相似.</p>
<p><img src="https://img.alicdn.com/imgextra/i1/581166664/TB2G54UiVXXXXcNXpXXXXXXXXXX_!!581166664.png"></p>
<h3 id="模拟数字电路"><a href="#模拟数字电路" class="headerlink" title="模拟数字电路"></a>模拟数字电路</h3><p>这也就是开始提到的使用电子工程师的眼光来看待问题的例子,在课程上老师也讲到了他认为电气系统是最完美的系统.</p>
<p>用与非门来构造一个半加器:</p>
<p><img src="https://ws1.sinaimg.cn/large/753800a6ly1fwesz6wx4qj20g705d0te.jpg"><br><img src="https://img.alicdn.com/imgextra/i2/581166664/TB2O48ZiVXXXXcnXpXXXXXXXXXX_!!581166664.png"></p>
<p>数字电路的优势就在于可以使用简单的模块构造出具有复杂功能的模块,然后使用复杂的模块构造出更复杂的模块,比较类似于第一章讲到pair时pair的闭包性质一样.</p>
<p>而数字电路设计的难点就在于信号在电路中的传输是有延迟的.</p>
<h3 id="约束传播"><a href="#约束传播" class="headerlink" title="约束传播"></a>约束传播</h3><p>在之前我们都把代码组织成单向的计算,而这里就举了一个可以从任何方向来求值的约束传播的例子.</p>
<p><img src="https://img.alicdn.com/imgextra/i1/581166664/TB2jEGbiVXXXXXDXpXXXXXXXXXX_!!581166664.png"></p>
<p>而这其实也是一种新的抽象问题的方式.</p>
<h2 id="并发-时间是本质问题"><a href="#并发-时间是本质问题" class="headerlink" title="并发:时间是本质问题"></a>并发:时间是本质问题</h2><blockquote>
<p>The central issue lurking beneath the complexity of state, sameness, and change is that by introducing assigment we forced to admit time to our computational models.</p>
</blockquote>
<blockquote>
<p>what makes this complicated is that more than one process may be trying to manipulate the shared state at the same time.</p>
</blockquote>
<p>一个两个人同时从银行中取钱的例子:</p>
<p><img src="https://img.alicdn.com/imgextra/i3/581166664/TB2lzajiVXXXXcHXXXXXXXXXXXX_!!581166664.png"></p>
<p>使得事情变得复杂的原因就在于多个进程可以同时操作同一个共享的状态,重要的就是如何<strong>保证操作的原子性</strong>,一种解决的办法就是使用<strong>Serializer</strong>(串行化),也就是类似于锁的机制.</p>
<p>而一旦引入了锁也就会有<strong>deadlock</strong>(死锁)的存在(这里就略过).</p>
<h3 id="并发-时间和交流"><a href="#并发-时间和交流" class="headerlink" title="并发,时间和交流"></a>并发,时间和交流</h3><blockquote>
<p>The basic phenomenon here is that synchronizing different processes, establishing shared state, or imposing an order on events requires communication among the process.</p>
</blockquote>
<p>一旦涉及到并发也就涉及到了通讯的问题,也就是进程之间分享同一个状态的方式,当然这就有很多的取舍可以做了,是要大家都能同时获取状态的变化还是可以延时获取状态的变化,而这个问题到了分布式中就会变得越发的明显,而Hadoop最大的性能瓶颈其实也就是在于网络的IO.</p>
<blockquote>
<p>从本质上看,在并发控制中,任何时间概念都必然与通信有内在的密切联系.有意思的是,时间与通信之间的这种联系也出现在相对论里,在那里的光速(可能用于同步事件的最快信号)是与时间和空间有关的基本常量.在处理时间和状态时,我们在计算模型领域所遭遇的复杂性,事实上,可能就是物理世界中最基本的复杂性的一种反映.</p>
</blockquote>
<p>可能这就是科学的共性吧.虽然感觉有点玄乎,但是这也是SICP的魅力所在吧.</p>
<h2 id="Streams-流"><a href="#Streams-流" class="headerlink" title="Streams(流)"></a>Streams(流)</h2><blockquote>
<p>streams are a clever idea that allows one to use sequence manipulations without incurring the cost of manipulating sequence as lists.</p>
</blockquote>
<p>简单的说流就是延时求值,也可以说是需求驱动(demand-driven)的,就是你要一个就给你一个,Python中的yield就是这种感觉.</p>
<h3 id="Infinite-Streams"><a href="#Infinite-Streams" class="headerlink" title="Infinite Streams"></a>Infinite Streams</h3><p>而使用<code>delay</code>和<code>force</code>来实现延时求值也使得我们可以做一些以前办不到的事,比如一个表示正整数的无穷流:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(define (integers-starting-from n)</span><br><span class="line">  (cons-stream n (integers-starting-from (+ n 1))))</span><br><span class="line">(define integers (integers-starting-from 1))</span><br></pre></td></tr></table></figure>

<h3 id="信号系统中的流"><a href="#信号系统中的流" class="headerlink" title="信号系统中的流"></a>信号系统中的流</h3><p>把积分过程看作是一个信号处理系统:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(define (integral integrand initial-value dt)</span><br><span class="line">    (define int</span><br><span class="line">        (cons-stream initial-value</span><br><span class="line">            (add-streams (scale-stream integrand dt)</span><br><span class="line">                            int)))</span><br><span class="line">int)</span><br></pre></td></tr></table></figure>

<p><img src="https://img.alicdn.com/imgextra/i2/581166664/TB2KcaeiVXXXXXtXpXXXXXXXXXX_!!581166664.png"></p>
<h3 id="函数式编程的模块化和对象的模块化"><a href="#函数式编程的模块化和对象的模块化" class="headerlink" title="函数式编程的模块化和对象的模块化"></a>函数式编程的模块化和对象的模块化</h3><p>如果我们把合并请求交易模块化的话,就像下面这样:</p>
<p><img src="https://img.alicdn.com/imgextra/i4/581166664/TB2o7KviVXXXXarXXXXXXXXXXXX_!!581166664.png"></p>
<p>问题在于我们每次都要接收Peter和Paul的请求才能进行一次合并,如果两个人请求的频率相差很大的话,那么频繁请求的人就会堆积很多请求不能处理,而一旦引入显式的同步来保证事件发生顺序的正确性的话,又会引入函数式编程中的一个大问题(因为显式同步引入了赋值和时间,这是函数式编程想避免的):也就是在没有时间这个属性的情况下如何去”公平”的合并两个请求.</p>
<h1 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h1><blockquote>
<p>We can model the world as a collection of separate, time-bound, interacting objects with state, or we can model the world as a single, timeless, stateless unity.</p>
</blockquote>
<p>我们面临的不是编程方法的挑战,而是两种不同的世界观的挑战,看待世界不同的方法导致了OO和FP两种分支,如果两个分支在将来能够融合的话是坠吼的.</p>
<blockquote>
<p>你问我支不支持,我肯定是支持的</p>
</blockquote>
<p>第三章的总结也到此结束了,可以说在SICP的这一段历程是玄幻的和充满乐趣的,这也是这本魔法书的魅力所在吧.而在项目中遇到的包括并发,分布式的问题也增加了对这些CS中基本的问题的思考:</p>
<blockquote>
<p>吾尝终日而思矣,不如须臾之所学也</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://misakatang.cn/2018/10/18/%E8%A1%A5%E5%85%85-%E5%9C%A8MockMvc%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%90%84%E7%A7%8DPOST%E6%8F%90%E4%BA%A4%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/misaka.jpg">
      <meta itemprop="name" content="MisakaTang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MisakaTang's Blog">
      <meta itemprop="description" content="The limits of my language are the limits of my world">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | MisakaTang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/10/18/%E8%A1%A5%E5%85%85-%E5%9C%A8MockMvc%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%90%84%E7%A7%8DPOST%E6%8F%90%E4%BA%A4%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">补充:在MockMvc中使用各种POST提交数据的方式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-18 21:44:29" itemprop="dateCreated datePublished" datetime="2018-10-18T21:44:29+00:00">2018-10-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-03-14 08:33:24" itemprop="dateModified" datetime="2024-03-14T08:33:24+00:00">2024-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/%E5%88%86%E7%B1%BB/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="application-x-www-form-urlencoded"><a href="#application-x-www-form-urlencoded" class="headerlink" title="application&#x2F;x-www-form-urlencoded"></a>application&#x2F;x-www-form-urlencoded</h1><p>这是比较常用的提交数据的方式,在项目中也使用的是这一种,在MockMvc测试的参数准备时可以这样使用:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UrlEncodedFormEntity</span> <span class="variable">form</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlEncodedFormEntity</span>(Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">BasicNameValuePair</span>(<span class="string">&quot;参数1&quot;</span>, value1),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">BasicNameValuePair</span>(<span class="string">&quot;参数2&quot;</span>, value2),</span><br><span class="line">        ), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"><span class="type">MvcResult</span> <span class="variable">result</span> <span class="operator">=</span> mvc.perform(MockMvcRequestBuilders.post(<span class="string">&quot;/test&quot;</span>)</span><br><span class="line">        .contentType(MediaType.APPLICATION_FORM_URLENCODED)</span><br><span class="line">        .content(EntityUtils.toString(form))</span><br><span class="line">)</span><br><span class="line">        .andExpect(status().isOk()).andReturn();</span><br></pre></td></tr></table></figure>
<p>主要使用的是<code>UrlEncodedFormEntity</code>类,要注意的是需要设置字符集否则传参的时候中文会变成<code>???</code>.</p>
<h1 id="application-json"><a href="#application-json" class="headerlink" title="application&#x2F;json"></a>application&#x2F;json</h1><p>我使用的是用阿里开源的fastjson直接转换的形式:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Parm</span> <span class="variable">parm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parm</span>(); <span class="comment">//你要传的参数的对象</span></span><br><span class="line"><span class="comment">//设置参数对象的值</span></span><br><span class="line"><span class="type">String</span> <span class="variable">requestJson</span> <span class="operator">=</span> JSONObject.toJSONString(parm);</span><br><span class="line"><span class="type">MvcResult</span> <span class="variable">result</span> <span class="operator">=</span> mockMvc.perform(post(<span class="string">&quot;/softs&quot;</span>)</span><br><span class="line">        .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">        .content(requestJson)</span><br><span class="line">)</span><br><span class="line">        .andDo(print())</span><br><span class="line">        .andExpect(status().isOk()).andReturn(); </span><br></pre></td></tr></table></figure>

<h1 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart&#x2F;form-data"></a>multipart&#x2F;form-data</h1><p>这个没有使用过,就借鉴Stack Overflow上的一个答案:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MockMultipartFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MockMultipartFile</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;dummy.csv&quot;</span>,</span><br><span class="line">        <span class="string">&quot;text/plain&quot;</span>, <span class="string">&quot;Some dataset...&quot;</span>.getBytes());</span><br><span class="line"></span><br><span class="line"><span class="type">MockMultipartHttpServletRequestBuilder</span> <span class="variable">builder</span> <span class="operator">=</span></span><br><span class="line">        MockMvcRequestBuilders.fileUpload(<span class="string">&quot;/test1/datasets/set1&quot;</span>);</span><br><span class="line">builder.with(<span class="keyword">new</span> <span class="title class_">RequestPostProcessor</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MockHttpServletRequest <span class="title function_">postProcessRequest</span><span class="params">(MockHttpServletRequest request)</span> &#123;</span><br><span class="line">        request.setMethod(<span class="string">&quot;PUT&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> request;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">mvc.perform(builder</span><br><span class="line">        .file(file))</span><br><span class="line">        .andExpect(status().ok());</span><br></pre></td></tr></table></figure>

<h1 id="get请求传参"><a href="#get请求传参" class="headerlink" title="get请求传参"></a>get请求传参</h1><p>这个虽然不是POST也很简单,但是也记录一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MvcResult</span> <span class="variable">result</span> <span class="operator">=</span> mvc.perform(MockMvcRequestBuilders.post(<span class="string">&quot;/v4/address/deleteAddress&quot;</span>)</span><br><span class="line">        .param(<span class="string">&quot;参数1&quot;</span>, value1)</span><br><span class="line">        .param(<span class="string">&quot;参数2&quot;</span>, value2)</span><br><span class="line">)</span><br><span class="line">        .andExpect(status().isOk()).andReturn();</span><br></pre></td></tr></table></figure>
<p>也可以使用params的方式使用Map来传参,但是我还是习惯这样来初始化,因为毕竟每个参数还是需要自己设置的,这样看起来也清晰一点.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/19/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><span class="page-number current">20</span><a class="page-number" href="/page/21/">21</a><span class="space">&hellip;</span><a class="page-number" href="/page/34/">34</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/21/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="user"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">MisakaTang</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/TangMisaka23001" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","mhchem":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
